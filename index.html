---

layout: default

---
<div class="row">
    <div class="col alert alert-info">
        <p>Want to submit your module? Check the instructions <a href="{{ site.baseurl }}/submit.html">here</a></p>
    </div>
</div>

<div class="row">
    <div class="col">
        <div id="search" class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text"><i class="fas fa-search"></i></span>
            </div>
             <input id="acmodule_search" class="form-control" type="text" placeholder="Search a module by name..." required="true" v-on:keyup.enter="doSearch" v-model="words"/>
        </div>
        <p class="text-muted">Press Enter to submit</p>
    </div>
</div>

<div class="row">
    <div class="col">
        <p id="loading_status" v-if="show"><i :class="icon"></i> (( message ))</p>
        <ul id="showcase" class="list-unstyled" v-if="items">
            <li class="media" v-for="item of items">
                <template>
                    <img class="mr-3 logo-small" :src="item.logo" alt="logo">
                    <div class="media-body">
                        <h4 class="mt-0 mb-1">
                            <a :href="'{{ site.baseurl }}/details.html?id=' + (( item.id ))">(( item.name ))</a>
                        </h4>
                        <p class="text-muted text-tiny"><i class="fas fa-star"></i> (( item.stargazers_count )) | Created (( item.created_at | created ))</p>
                        <p>(( item.description ))</p>
                    </div>
                </template>
            </li>
        </ul>
    </div>
</div>

<script type="text/javascript">

var searchBar = new Vue({
  el: '#acmodule_search',
  data: {
    words: ''
  },
  methods: {
    doSearch: function() {
      list_modules(this.words);
      this.words = '';
    }
  }
});

var mList = new Vue({
  el: '#showcase',
  delimiters: ['((', '))'],
  data: {
    items: []
  },
  methods: {
    loadItems: function (_items) {
        this.items = _items;

        this.items.forEach((item, idx) =>{
            item.logo = item.owner.avatar_url;
            let iconUrl = `https://raw.githubusercontent.com/${item.full_name}/${item.default_branch}/icon.png`;
            $.get(iconUrl, (res) => {
                item.logo = iconUrl;
                Vue.set(mList.items, idx, item);
            });
        });
    }
  },
  filters: {
    created: function(date) {
        return moment(date).fromNow();
    }
  }
});

var mStatus = new Vue({
    el: '#loading_status',
    delimiters: ['((', '))'],
    data: {
        message: '',
        icon: '',
        show: false
    },
    methods: {
        hideMessage: function() {
            this.show = false;
        },
        showError: function(msg) {
            this.message = msg;
            this.icon = 'far fa-times-circle';
            this.show = true;
        },
        showLoading: function() {
            this.message = 'Searching for repositories...';
            this.icon = 'fas fa-sync fa-spin';
            this.show = true;
            mList.loadItems([]);
        }
    }
});

function list_modules(search) {
    mStatus.showLoading();

    if (search != "")
        search ='+'+search;
    var url  = 'https://api.github.com/search/repositories?q=org:azerothcore+fork:true+topic:core-module+sort:stars' + search;

    $.getJSON(url, json => {
        if (json.items.length > 0)
        {
            mList.loadItems(json.items);
            mStatus.hideMessage();
        } else {
            mStatus.showError('No results found');
        }
    });
}

$(document).ready(() => { list_modules('') });
</script>